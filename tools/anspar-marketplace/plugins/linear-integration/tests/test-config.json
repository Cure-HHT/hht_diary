{
  "tests": {
    "metadata": {
      "name": "Plugin Metadata Tests",
      "tests": [
        {
          "name": "Valid plugin.json structure",
          "type": "validation",
          "target": ".claude-plugin/plugin.json",
          "checks": [
            {
              "field": "name",
              "required": true,
              "pattern": {}
            },
            {
              "field": "version",
              "required": true,
              "pattern": {}
            },
            {
              "field": "description",
              "required": true,
              "minLength": 1,
              "maxLength": 500
            },
            {
              "field": "author",
              "required": true,
              "type": "object"
            },
            {
              "field": "author.name",
              "required": true,
              "minLength": 1
            }
          ]
        },
        {
          "name": "Valid marketplace.json if present",
          "type": "validation",
          "target": ".claude-plugin/marketplace.json",
          "optional": true,
          "checks": [
            {
              "field": "plugins",
              "required": true,
              "type": "array"
            },
            {
              "field": "owner",
              "required": true,
              "type": "object"
            }
          ]
        }
      ]
    },
    "commands": [
      {
        "name": "Command: linear-checklist",
        "tests": [
          {
            "name": "Command file exists",
            "type": "file-exists",
            "target": "commands/linear-checklist.md"
          },
          {
            "name": "Valid frontmatter",
            "type": "frontmatter-validation",
            "target": "commands/linear-checklist.md",
            "checks": [
              {
                "field": "name",
                "required": true
              },
              {
                "field": "description",
                "required": true
              },
              {
                "field": "arguments",
                "required": true
              }
            ]
          },
          {
            "name": "Command execution test",
            "type": "execution",
            "command": "linear-checklist",
            "args": [
              "--help"
            ],
            "expectedOutput": "should provide help information",
            "expectedError": false
          }
        ]
      },
      {
        "name": "Command: linear-fetch",
        "tests": [
          {
            "name": "Command file exists",
            "type": "file-exists",
            "target": "commands/linear-fetch.md"
          },
          {
            "name": "Valid frontmatter",
            "type": "frontmatter-validation",
            "target": "commands/linear-fetch.md",
            "checks": [
              {
                "field": "name",
                "required": true
              },
              {
                "field": "description",
                "required": true
              },
              {
                "field": "arguments",
                "required": true
              }
            ]
          },
          {
            "name": "Command execution test",
            "type": "execution",
            "command": "linear-fetch",
            "args": [
              "--help"
            ],
            "expectedOutput": "should provide help information",
            "expectedError": false
          }
        ]
      },
      {
        "name": "Command: linear-search",
        "tests": [
          {
            "name": "Command file exists",
            "type": "file-exists",
            "target": "commands/linear-search.md"
          },
          {
            "name": "Valid frontmatter",
            "type": "frontmatter-validation",
            "target": "commands/linear-search.md",
            "checks": [
              {
                "field": "name",
                "required": true
              },
              {
                "field": "description",
                "required": true
              },
              {
                "field": "arguments",
                "required": true
              }
            ]
          },
          {
            "name": "Command execution test",
            "type": "execution",
            "command": "linear-search",
            "args": [
              "--help"
            ],
            "expectedOutput": "should provide help information",
            "expectedError": false
          }
        ]
      }
    ],
    "agents": [
      {
        "name": "Agent: linear-agent",
        "tests": [
          {
            "name": "Agent file exists",
            "type": "file-exists",
            "target": "agents/linear-agent.md"
          },
          {
            "name": "Valid agent structure",
            "type": "content-validation",
            "target": "agents/linear-agent.md",
            "checks": [
              {
                "contains": "# Role"
              },
              {
                "contains": "linear-agent"
              }
            ]
          },
          {
            "name": "Agent invocation test",
            "type": "agent-invocation",
            "agent": "linear-agent",
            "input": "Test input for agent",
            "expectedBehavior": "Agent responds appropriately"
          }
        ]
      }
    ],
    "skills": [
      {
        "name": "Skill: add-requirement-checklist",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/add-requirement-checklist"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/add-requirement-checklist/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/add-requirement-checklist/SKILL.md",
            "checks": [
              {
                "contains": "add-requirement-checklist"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      },
      {
        "name": "Skill: create-requirement-tickets",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/create-requirement-tickets"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/create-requirement-tickets/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/create-requirement-tickets/SKILL.md",
            "checks": [
              {
                "contains": "create-requirement-tickets"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      },
      {
        "name": "Skill: create-ticket",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/create-ticket"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/create-ticket/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/create-ticket/SKILL.md",
            "checks": [
              {
                "contains": "create-ticket"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      },
      {
        "name": "Skill: fetch-by-label",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/fetch-by-label"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/fetch-by-label/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/fetch-by-label/SKILL.md",
            "checks": [
              {
                "contains": "fetch-by-label"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      },
      {
        "name": "Skill: fetch-tickets",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/fetch-tickets"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/fetch-tickets/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/fetch-tickets/SKILL.md",
            "checks": [
              {
                "contains": "fetch-tickets"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      },
      {
        "name": "Skill: initialize",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/initialize"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/initialize/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/initialize/SKILL.md",
            "checks": [
              {
                "contains": "initialize"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      },
      {
        "name": "Skill: list-labels",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/list-labels"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/list-labels/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/list-labels/SKILL.md",
            "checks": [
              {
                "contains": "list-labels"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      },
      {
        "name": "Skill: search-tickets",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/search-tickets"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/search-tickets/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/search-tickets/SKILL.md",
            "checks": [
              {
                "contains": "search-tickets"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      },
      {
        "name": "Skill: update-ticket",
        "tests": [
          {
            "name": "Skill directory exists",
            "type": "directory-exists",
            "target": "skills/update-ticket"
          },
          {
            "name": "SKILL.md file exists",
            "type": "file-exists",
            "target": "skills/update-ticket/SKILL.md"
          },
          {
            "name": "Skill content validation",
            "type": "content-validation",
            "target": "skills/update-ticket/SKILL.md",
            "checks": [
              {
                "contains": "update-ticket"
              },
              {
                "contains": "## Purpose"
              }
            ]
          }
        ]
      }
    ],
    "hooks": [
      {
        "name": "Hook: SessionStart",
        "tests": [
          {
            "name": "Hook configuration valid",
            "type": "hook-validation",
            "event": "SessionStart",
            "command": [
              {
                "hooks": [
                  {
                    "type": "command",
                    "command": "node ${CLAUDE_PLUGIN_ROOT}/scripts/test-config.js"
                  }
                ]
              }
            ]
          },
          {
            "name": "Hook script exists if referenced",
            "type": "conditional-file-exists",
            "condition": false,
            "target": "hooks/undefined"
          },
          {
            "name": "Hook execution test",
            "type": "hook-execution",
            "event": "SessionStart",
            "testEnv": {
              "CLAUDE_TOOL_NAME": "test-tool",
              "CLAUDE_TOOL_PARAMS": "{}"
            },
            "expectedExitCode": 0
          }
        ]
      }
    ],
    "integration": [
      {
        "name": "Plugin loads successfully",
        "type": "plugin-load",
        "pluginPath": ".",
        "expectedComponents": [
          "commands",
          "agents",
          "skills",
          "hooks"
        ]
      },
      {
        "name": "Commands and agents interact correctly",
        "type": "component-interaction",
        "scenario": "Command invokes agent",
        "steps": [
          {
            "action": "invoke-command",
            "target": "linear-checklist"
          },
          {
            "verify": "agent-activated",
            "target": "linear-agent"
          }
        ]
      },
      {
        "name": "Error handling works correctly",
        "type": "error-handling",
        "scenarios": [
          {
            "name": "Invalid command arguments",
            "action": "invoke-command",
            "args": [
              "--invalid-arg"
            ],
            "expectedError": true
          },
          {
            "name": "Hook timeout handling",
            "action": "trigger-hook",
            "event": "before-tool-use",
            "simulateTimeout": true,
            "expectedBehavior": "graceful-failure"
          }
        ]
      }
    ]
  },
  "runner": "bash",
  "timeout": 30000
}